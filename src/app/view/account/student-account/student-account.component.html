<app-toast #toast></app-toast>
<div class="row g-0 content-col">
  <div class="col-12 border-bottom bg-white px-2 py-3">
    <h4 class="header">Account</h4>
    <div class="sub-header">Manage account information</div>
  </div>
  <!-- <div class="col-12 border-bottom bg-white"></div> -->
  <div class="col-lg-4 col-12 content-col-str border">
    <div class="w-100 p-2 border-start border-5">
      <b>Student Details</b>
    </div>
    <div *ngIf="student$ | async as student" class="w-100 p-2 border-top bg-white">
      <form [formGroup]="studentFormGroup" (ngSubmit)="updateStudent(studentCV, studentMiniTranscript, studentCoverLetter, studentCourseOutline, studentSL)">
        <div class="row g-2 py-1">
          <div class="col-lg-6 col-12">
            <label for="studentName" class="form-label mb-1">Full name</label>
            <input oninput="this.value = this.value.toUpperCase()" type="text" class="form-control form-control-sm" formControlName="studentName" id="studentName" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentName', 'required', true)}">
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentName', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentName', 'required')">Name is required</span>
            </div>
          </div>
          <div class="col-lg-6 col-12">
            <label for="studentMatricNum" class="form-label mb-1">Matric number</label>
            <input type="number" class="form-control form-control-sm" formControlName="studentMatricNum" id="studentMatricNum" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentMatricNum', 'required', true)}">
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentMatricNum', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentMatricNum', 'required')">Matric number is required</span>
            </div>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-4 col-12">
            <label for="studentEmail" class="form-label mb-1">Email</label>
            <input type="text" class="form-control form-control-sm" formControlName="studentEmail" id="studentEmail" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentEmail', 'required', true) || appUtilityService.checkFormGroupValid(studentFormGroup, 'studentEmail', 'email', true)}">
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentEmail', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentEmail', 'required')">Email is required</span>
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentEmail', 'email')">Invalid email pattern</span>
            </div>
          </div>
          <div class="col-lg-4 col-12">
            <label for="studentPassword" class="form-label mb-1">Password</label>
            <input type="text" class="form-control form-control-sm" formControlName="studentPassword" id="studentPassword" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentPassword', 'required', true)}">
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentPassword', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentPassword', 'required')">Password is required</span>
            </div>
          </div>
          <div class="col-lg-4 col-12">
            <label for="studentPhone" class="form-label mb-1">Phone number</label>
            <div class="input-group input-group-sm">
              <span class="input-group-text">+60</span>
              <input type="text" class="form-control" formControlName="studentPhone" id="studentPhone" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentPhone', 'required', true)}">
            </div>
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentPhone', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentPhone', 'required')">Phone number is required</span>
            </div>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-4 col-12">
            <label for="studentCampus" class="form-label mb-1">Campus</label>
            <app-search-select [formGroup]="studentFormGroup" [formControlString]="'studentCampus'" [formGroupId]="'studentCampus'" [formGroupError]="appUtilityService.checkFormGroupValid(studentFormGroup, 'studentCampus', 'required', true)" [options]="(campusList$ | async)!"></app-search-select>
            <!-- <input oninput="this.value = this.value.toUpperCase()" type="text" class="form-control form-control-sm" formControlName="studentCampus" id="studentCampus" [ngClass]="{'is-invalid': }"> -->
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentCampus', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentCampus', 'required')">Campus is required</span>
            </div>
          </div>
          <div class="col-lg-4 col-12">
            <label for="studentCourse" class="form-label mb-1">Course</label>
            <app-search-select [formGroup]="studentFormGroup" [formControlString]="'studentCourse'" [formGroupId]="'studentCourse'" [formGroupError]="appUtilityService.checkFormGroupValid(studentFormGroup, 'studentCourse', 'required', true)" [options]="(courseList$ | async)!"></app-search-select>
            <!-- <input oninput="this.value = this.value.toUpperCase()" type="text" class="form-control form-control-sm" formControlName="studentCourse" id="studentCourse" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentCourse', 'required', true)}"> -->
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentCourse', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentCourse', 'required')">Course is required</span>
            </div>
          </div>
          <div class="col-lg-4 col-12">
            <label for="studentClass" class="form-label mb-1">Class</label>
            <app-search-select [formGroup]="studentFormGroup" [formControlString]="'studentClass'" [formGroupId]="'studentClass'" [formGroupError]="appUtilityService.checkFormGroupValid(studentFormGroup, 'studentClass', 'required', true)" [options]="(classList$ | async)!"></app-search-select>
            <!-- <input oninput="this.value = this.value.toUpperCase()" type="text" class="form-control form-control-sm" formControlName="studentClass" id="studentClass" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentClass', 'required', true)}"> -->
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentClass', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentClass', 'required')">Class is required</span>
            </div>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-12 col-12">
            <label for="studentAddress" class="form-label mb-1">Address</label>
            <textarea oninput="this.value = this.value.toUpperCase()" formControlName="studentAddress" id="studentAddress" class="form-control form-control-sm textarea-no-resize" rows="5" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentAddress', 'required', true)}"></textarea>
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentAddress', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentAddress', 'required')">Address is required</span>
            </div>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-6 col-12">
            <label for="academicSvId" class="form-label mb-1">Academic supervisor</label>
            <select class="form-select form-select-sm" formControlName="academicSvId" id="academicSvId">
              <option value="" selected hidden></option>
              <option *ngFor="let academicSV of (academicSVs$ | async)" [value]="academicSV.academicSvId">{{ academicSV.academicSvName }}</option>
            </select>
          </div>
          <div class="col-lg-6 col-12">
            <label for="industrySvId" class="form-label mb-1">Industry supervisor</label>
            <select class="form-select form-select-sm" formControlName="industrySvId" id="industrySvId">
              <option value="" selected hidden></option>
              <option *ngFor="let industrySV of (industrySVs$ | async)" [value]="industrySV.industrySvId">{{ industrySV.industrySvName }}</option>
            </select>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-12 col-12">
            <label for="studentProject" class="form-label mb-1">Project</label>
            <input oninput="this.value = this.value.toUpperCase()" type="text" class="form-control form-control-sm" formControlName="studentProject" id="studentProject">
          </div>
        </div>
        <div class="row g-0 py-1">
          <div class="col-lg-3 col-12">
            <label for="studentCV" class="form-label mb-1 mt-5px">Resume</label>
          </div>
          <div class="col-lg-9 col-12">
            <div class="input-group">
              <input #studentCV type="file" class="form-control form-control-sm" formControlName="studentCV" accept="application/pdf" id="studentCV" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentCV', 'invalidFileType', true)}">
              <button type="button" *ngIf="appUtilityService.isObjectNotEmpty(student)" [disabled]="!student.studentCV" (click)="appUtilityService.onDisplayFile(student.studentCV!)" class="input-group-text">
                <i class="fa fa-expand fw-bold"></i>
              </button>
            </div>
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentCV', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentCV', 'invalidFileType')">Invalid file type</span>
            </div>
          </div>
        </div>
        <div class="row g-0 py-1">
          <div class="col-lg-3 col-12">
            <label for="studentMiniTranscript" class="form-label mt-5px">Mini Transcript</label>
          </div>
          <div class="col-lg-9 col-12">
            <div class="input-group">
              <input #studentMiniTranscript type="file" class="form-control form-control-sm" formControlName="studentMiniTranscript" accept="application/pdf" id="studentMiniTranscript" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentMiniTranscript', 'invalidFileType', true)}">
              <button type="button" *ngIf="appUtilityService.isObjectNotEmpty(student)" [disabled]="!student.studentMiniTranscript" (click)="appUtilityService.onDisplayFile(student.studentMiniTranscript!)" class="input-group-text">
                <i class="fa fa-expand fw-bold"></i>
              </button>
            </div>
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentMiniTranscript', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentMiniTranscript', 'invalidFileType')">Invalid file type</span>
            </div>
          </div>
        </div>
        <div class="row g-0 py-1">
          <div class="col-lg-3 col-12">
            <label for="studentCoverLetter" class="form-label mt-5px">Cover letter</label>
          </div>
          <div class="col-lg-9 col-12">
            <div class="input-group">
              <input #studentCoverLetter type="file" class="form-control form-control-sm" formControlName="studentCoverLetter" accept="application/pdf" id="studentCoverLetter" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentCoverLetter', 'invalidFileType', true)}">
              <button type="button" *ngIf="appUtilityService.isObjectNotEmpty(student)" [disabled]="!student.studentCoverLetter" (click)="appUtilityService.onDisplayFile(student.studentCoverLetter!)" class="input-group-text">
                <i class="fa fa-expand fw-bold"></i>
              </button>
            </div>
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentCoverLetter', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentCoverLetter', 'invalidFileType')">Invalid file type</span>
            </div>
          </div>
        </div>
        <div class="row g-0 py-1">
          <div class="col-lg-3 col-12">
            <label for="studentCourseOutline" class="form-label mt-5px">Course outline</label>
          </div>
          <div class="col-lg-9 col-12">
            <div class="input-group">
              <input #studentCourseOutline type="file" class="form-control form-control-sm" formControlName="studentCourseOutline" accept="application/pdf" id="studentCourseOutline" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentCourseOutline', 'invalidFileType', true)}">
              <button type="button" *ngIf="appUtilityService.isObjectNotEmpty(student)" [disabled]="!student.studentCourseOutline" (click)="appUtilityService.onDisplayFile(student.studentCourseOutline!)" class="input-group-text">
                <i class="fa fa-expand fw-bold"></i>
              </button>
            </div>
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentCourseOutline', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentCourseOutline', 'invalidFileType')">Invalid file type</span>
            </div>
          </div>
        </div>
        <div class="row g-0 py-1">
          <div class="col-lg-3 col-12">
            <label for="studentSL" class="form-label mt-5px">SL01</label>
          </div>
          <div class="col-lg-9 col-12">
            <div class="input-group">
              <input #studentSL type="file" class="form-control form-control-sm" formControlName="studentSL" id="studentSL" accept="application/pdf" [ngClass]="{'is-invalid': appUtilityService.checkFormGroupValid(studentFormGroup, 'studentSL', 'invalidFileType', true)}">
              <button type="button" *ngIf="appUtilityService.isObjectNotEmpty(student)" [disabled]="!student.studentSL" (click)="appUtilityService.onDisplayFile(student.studentSL!)" class="input-group-text">
                <i class="fa fa-expand fw-bold"></i>
              </button>
            </div>
            <div *ngIf="appUtilityService.checkFormGroupSubmitted(studentFormGroup, 'studentSL', true)" class="form-label-error w-100 mt-1">
              <span *ngIf="appUtilityService.checkFormGroupHasError(studentFormGroup, 'studentSL', 'invalidFileType')">Invalid file type</span>
            </div>
          </div>
        </div>
        <div class="row g-0 py-1">
          <div class="col-lg-6 col-12"></div>
          <div class="col-lg-6 col-12">
            <app-button-group class="float-end" [btnType]="'submit'" [btnTxt]="'Submit'" [btnIcn]="'fa-check'" [btnContentColor]="'#fff'" [btnBgClass]="'bg-primary'" [btnBorderClass]="'border-primary'"></app-button-group>
            <app-button-group class="float-end me-2" (onClick)="getStudent(); getSupervisors()" [btnType]="'button'" [btnTxt]="'Reset'" [btnIcn]="'fa-refresh'" [btnContentColor]="'#fff'" [btnBgClass]="'bg-secondary'" [btnBorderClass]="'border-secondary'"></app-button-group>
          </div>
        </div>
      </form>
    </div>
  </div>
  <ng-container *ngIf="academicSV$ | async as academicSV">
    <div *ngIf="appUtilityService.isObjectNotEmpty(academicSV)" class="col-lg-4 col-12 content-col-str border">
      <div class="w-100 p-2 border-start border-5">
        <b>Academic Supervisor</b>
      </div>
      <div class="w-100 p-2 border-top bg-white">
        <div class="row g-2 py-1">
          <div class="col-lg-12 col-12">
            <label class="form-label mb-1">Full name</label>
            <input type="text" class="form-control form-control-sm" [value]="academicSV.academicSvName" disabled>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-6 col-12">
            <label class="form-label mb-1">Email</label>
            <input type="text" class="form-control form-control-sm" [value]="academicSV.academicSvEmail" disabled>
          </div>
          <div class="col-lg-6 col-12">
            <label class="form-label mb-1">Phone number</label>
            <input type="text" class="form-control form-control-sm" [value]="academicSV.academicSvPhone" disabled>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-6 col-12">
            <label class="form-label mb-1">Gender</label>
            <select class="form-select form-select-sm" [value]="academicSV.academicSvGender" disabled>
              <option value="MALE">MALE</option>
              <option value="FEMALE">FEMALE</option>
            </select>
          </div>
          <div class="col-lg-6 col-12">
            <label class="form-label mb-1">Position</label>
            <input type="text" class="form-control form-control-sm" [value]="academicSV.academicSvPosition" disabled>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
  <ng-container *ngIf="industrySV$ | async as industrySV">
    <div *ngIf="appUtilityService.isObjectNotEmpty(industrySV)" class="col-lg-4 col-12 content-col-str border">
      <div class="w-100 p-2 border-start border-5">
        <b>Industry Supervisor</b>
      </div>
      <div *ngIf="industrySV$ | async as industrySV" class="w-100 p-2 border-top bg-white">
        <div class="row g-2 py-1">
          <div class="col-lg-12 col-12">
            <label class="form-label mb-1">Full name</label>
            <input type="text" class="form-control form-control-sm" [value]="industrySV.industrySvName" disabled>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-6 col-12">
            <label class="form-label mb-1">Email</label>
            <input type="text" class="form-control form-control-sm" [value]="industrySV.industrySvEmail" disabled>
          </div>
          <div class="col-lg-6 col-12">
            <label class="form-label mb-1">Phone number</label>
            <input type="text" class="form-control form-control-sm" [value]="industrySV.industrySvPhone" disabled>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-6 col-12">
            <label class="form-label mb-1">Gender</label>
            <select class="form-select form-select-sm" [value]="industrySV.industrySvGender" disabled>
              <option value="MALE">MALE</option>
              <option value="FEMALE">FEMALE</option>
            </select>
          </div>
          <div class="col-lg-6 col-12">
            <label class="form-label mb-1">Position</label>
            <input type="text" class="form-control form-control-sm" [value]="industrySV.industrySvPosition" disabled>
          </div>
        </div>
        <div class="row g-2 py-1">
          <div class="col-lg-12 col-12">
            <label class="form-label mb-1">Company</label>
            <input type="text" class="form-control form-control-sm" [value]="industrySV.company!.companyName" disabled>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>
